(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{3806:function(e,a,t){Promise.resolve().then(t.bind(t,3242))},3242:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var r=t(7437),n=t(2265),s=t(4033),i=t(1396),l=t.n(i),c=t(9113);function o(e){let{campaign:a,userType:t,onJoin:s}=e,[i,c]=(0,n.useState)(!1),o=e=>{let a=new Date(e);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(a)},d=()=>!!a.participations&&0!==a.participations.length&&a.participations.some(e=>"rejected"!==e.status),m=async()=>{if(s)try{c(!0),await s(a.id)}catch(e){console.error("Erro ao participar da campanha:",e)}finally{c(!1)}},u=(()=>{let e=new Date(a.end_date),t=new Date;return Math.ceil((e.getTime()-t.getTime())/864e5)})();return(0,r.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 truncate",children:a.title}),"creator"===t&&a.brands&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:a.brands.name})]}),(0,r.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat((e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"draft":default:return"bg-gray-100 text-gray-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800"}})(a.status)),children:(e=>{switch(e){case"active":return"Ativa";case"draft":return"Rascunho";case"completed":return"Conclu\xedda";case"cancelled":return"Cancelada";default:return e}})(a.status)})]}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500 line-clamp-2",children:a.description}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),(0,r.jsxs)("span",{className:"text-gray-500",children:[o(a.start_date)," - ",o(a.end_date)]})]}),u>0&&"active"===a.status&&(0,r.jsxs)("span",{className:"text-primary font-medium",children:[u," ",1===u?"dia":"dias"," restantes"]})]}),a.budget&&"creator"===t&&(0,r.jsxs)("div",{className:"mt-2 flex items-center text-sm",children:[(0,r.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6c.304 0 .792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95c-.285.475-.507 1-.67 1.55H6a1 1 0 000 2h.013a9.358 9.358 0 000 1H6a1 1 0 100 2h.351c.163.55.385 1.075.67 1.55C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 10-1.715-1.029c-.472.786-.96.979-1.264.979-.304 0-.792-.193-1.264-.979a4.265 4.265 0 01-.264-.521H10a1 1 0 100-2H8.017a7.36 7.36 0 010-1H10a1 1 0 100-2H8.472c.08-.185.167-.36.264-.521z",clipRule:"evenodd"})}),(0,r.jsxs)("span",{className:"text-gray-500",children:["Or\xe7amento: R$ ",a.budget.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-4 sm:px-6 flex justify-between items-center",children:[(0,r.jsx)(l(),{href:"/dashboard/".concat("brand"===t?"campaigns":"opportunities","/").concat(a.id),className:"text-sm font-medium text-primary hover:text-primary-dark",children:"Ver detalhes"}),"creator"===t&&"active"===a.status&&!d()&&(0,r.jsx)("button",{type:"button",onClick:m,disabled:i,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:i?"Participando...":"Participar"}),"creator"===t&&d()&&(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-primary bg-primary-light bg-opacity-20",children:"Participando"})]})]})}function d(){let e=(0,s.useRouter)(),{user:a}=(0,c.useSupabase)(),[t,i]=(0,n.useState)(null),[d,m]=(0,n.useState)([]),[u,x]=(0,n.useState)(!0),[h,p]=(0,n.useState)(null),[g,f]=(0,n.useState)(1),[b,y]=(0,n.useState)(1),[v,j]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!a){e.push("/auth/login");return}(async()=>{try{var e;let t=(null===(e=a.user_metadata)||void 0===e?void 0:e.user_type)||null;i(t),w(t,1)}catch(e){console.error("Error fetching user data:",e),p("Erro ao carregar dados do usu\xe1rio"),x(!1)}})()},[a,e]);let w=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var r;x(!0),p(null);let e=new URLSearchParams;e.append("page",a.toString()),e.append("limit","9"),t&&e.append("status",t);let n=await fetch("/api/campaigns?".concat(e.toString())),s=await n.json();if(!n.ok)throw Error(s.error||"Erro ao carregar campanhas");m(s.campaigns||[]),y((null===(r=s.pagination)||void 0===r?void 0:r.pages)||1),f(a)}catch(e){console.error("Error fetching campaigns:",e),p(e.message||"Erro ao carregar campanhas")}finally{x(!1)}},N=e=>{w(t,e,v)},C=e=>{j(e),w(t,1,e)},S=async e=>{try{let a=await fetch("/api/participations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaign_id:e})}),r=await a.json();if(!a.ok)throw Error(r.error||"Erro ao participar da campanha");w(t,g,v)}catch(e){console.error("Error joining campaign:",e),alert(e.message||"Erro ao participar da campanha")}};return u&&0===d.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"w-16 h-16 border-t-4 border-primary border-solid rounded-full animate-spin"})}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"md:flex md:items-center md:justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"brand"===t?"Minhas Campanhas":"Oportunidades"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"brand"===t?"Gerencie suas campanhas de marketing com influenciadores":"Encontre oportunidades para colaborar com marcas"})]}),"brand"===t&&(0,r.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:(0,r.jsx)(l(),{href:"/dashboard/campaigns/new",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Nova Campanha"})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{onClick:()=>C(null),className:"px-3 py-1 rounded-full text-sm font-medium ".concat(null===v?"bg-primary text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Todas"}),(0,r.jsx)("button",{onClick:()=>C("active"),className:"px-3 py-1 rounded-full text-sm font-medium ".concat("active"===v?"bg-primary text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Ativas"}),(0,r.jsx)("button",{onClick:()=>C("draft"),className:"px-3 py-1 rounded-full text-sm font-medium ".concat("draft"===v?"bg-primary text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Rascunhos"}),(0,r.jsx)("button",{onClick:()=>C("completed"),className:"px-3 py-1 rounded-full text-sm font-medium ".concat("completed"===v?"bg-primary text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:"Conclu\xeddas"})]})}),h&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-red-700",children:h})})})}),0===d.length?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:v?"Nenhuma campanha ".concat("active"===v?"ativa":"draft"===v?"em rascunho":"conclu\xedda"," encontrada"):"Nenhuma campanha encontrada"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"brand"===t?"Comece criando sua primeira campanha para conectar-se com influenciadores":"N\xe3o h\xe1 oportunidades dispon\xedveis no momento. Volte mais tarde!"}),"brand"===t&&(0,r.jsx)(l(),{href:"/dashboard/campaigns/new",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Criar Campanha"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(e=>(0,r.jsx)(o,{campaign:e,userType:t||"creator",onJoin:"creator"===t?S:void 0},e.id))}),b>1&&(0,r.jsx)("div",{className:"mt-8 flex justify-center",children:(0,r.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,r.jsxs)("button",{onClick:()=>N(g-1),disabled:1===g,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ".concat(1===g?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"sr-only",children:"Anterior"}),(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),Array.from({length:b},(e,a)=>a+1).map(e=>(0,r.jsx)("button",{onClick:()=>N(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(g===e?"z-10 bg-primary border-primary text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},e)),(0,r.jsxs)("button",{onClick:()=>N(g+1),disabled:g===b,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ".concat(g===b?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"sr-only",children:"Pr\xf3xima"}),(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]})}},1097:function(e,a,t){"use strict";t.d(a,{O:function(){return l}});var r=t(4566),n=t(2601);let s=n.env.NEXT_PUBLIC_SUPABASE_URL||"",i=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",l=(0,r.eI)(s,i)},9113:function(e,a,t){"use strict";t.r(a),t.d(a,{SupabaseProvider:function(){return c},useSupabase:function(){return l}});var r=t(7437),n=t(2265),s=t(1097);let i=(0,n.createContext)({user:null,session:null,isLoading:!0}),l=()=>(0,n.useContext)(i);function c(e){let{children:a}=e,[t,l]=(0,n.useState)(null),[c,o]=(0,n.useState)(null),[d,m]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let{data:{subscription:e}}=s.O.auth.onAuthStateChange((e,a)=>{var t;o(a),l(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null),m(!1)});return s.O.auth.getSession().then(e=>{var a;let{data:{session:t}}=e;o(t),l(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),m(!1)}),()=>{e.unsubscribe()}},[]),(0,r.jsx)(i.Provider,{value:{user:t,session:c,isLoading:d},children:a})}},1396:function(e,a,t){e.exports=t(5250)},4033:function(e,a,t){e.exports=t(5313)}},function(e){e.O(0,[788,250,971,938,744],function(){return e(e.s=3806)}),_N_E=e.O()}]);