(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{1685:(e,t,s)=>{Promise.resolve().then(s.bind(s,8790))},2401:(e,t,s)=>{"use strict";s.d(t,{SupabaseProvider:()=>o,_:()=>l});var a=s(5155),r=s(2115),n=s(2643);let i=(0,r.createContext)({user:null,session:null,isLoading:!0}),l=()=>(0,r.useContext)(i);function o(e){let{children:t}=e,[s,l]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[c,m]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let{data:{subscription:e}}=n.N.auth.onAuthStateChange((e,t)=>{var s;d(t),l(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),m(!1)});return n.N.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;d(s),l(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),m(!1)}),()=>{e.unsubscribe()}},[]),(0,a.jsx)(i.Provider,{value:{user:s,session:o,isLoading:c},children:t})}},2643:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(6302).UU)("https://example.supabase.co","example-anon-key")},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8790:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),r=s(2115),n=s(5695),i=s(2401);function l(e){let{onSuccess:t,onCancel:s}=e,i=(0,n.useRouter)(),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[m,u]=(0,r.useState)({title:"",description:"",objectives:[],start_date:"",end_date:"",budget:"",rules:{min_followers:1e3,required_platforms:["instagram"],content_requirements:"",hashtags:[]},requirements:{content_type:"post",min_posts:1,use_coupon:!0}}),[h,p]=(0,r.useState)(""),[x,b]=(0,r.useState)(""),g=e=>{let{name:t,value:s}=e.target;if(t.includes(".")){let[e,a]=t.split("."),r=m[e];r&&"object"==typeof r&&u({...m,[e]:{...r,[a]:s}})}else u({...m,[t]:s})},f=e=>{let{name:t,value:s}=e.target;if(t.includes(".")){let[e,a]=t.split("."),r=m[e];r&&"object"==typeof r&&u({...m,[e]:{...r,[a]:""===s?"":parseInt(s)}})}else u({...m,[t]:""===s?"":parseFloat(s)})},j=e=>{let t=m.rules.required_platforms;t.includes(e)?u({...m,rules:{...m.rules,required_platforms:t.filter(t=>t!==e)}}):u({...m,rules:{...m.rules,required_platforms:[...t,e]}})},v=e=>{u({...m,objectives:m.objectives.filter((t,s)=>s!==e)})},y=e=>{u({...m,rules:{...m.rules,hashtags:m.rules.hashtags.filter((t,s)=>s!==e)}})},N=async e=>{e.preventDefault();try{if(o(!0),c(null),!m.title||!m.description||!m.start_date||!m.end_date){c("Por favor, preencha todos os campos obrigat\xf3rios.");return}let e=new Date(m.start_date),s=new Date(m.end_date);if(e>=s){c("A data de in\xedcio deve ser anterior \xe0 data de t\xe9rmino.");return}let a={...m,start_date:e.toISOString(),end_date:s.toISOString(),status:"draft",rules:JSON.stringify(m.rules),requirements:JSON.stringify(m.requirements)},r=await fetch("/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),n=await r.json();if(!r.ok)throw Error(n.error||"Erro ao criar campanha");t?t(n.campaign):i.push("/dashboard/campaigns/".concat(n.campaign.id))}catch(e){c(e.message||"Ocorreu um erro ao criar a campanha. Por favor, tente novamente.")}finally{o(!1)}};return(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Nova Campanha"}),d&&(0,a.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-red-700",children:d})})})}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"Informa\xe7\xf5es B\xe1sicas"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"T\xedtulo da Campanha *"}),(0,a.jsx)("input",{type:"text",id:"title",name:"title",value:m.title,onChange:g,className:"input-field mt-1",placeholder:"Ex: Campanha de Ver\xe3o 2025",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Descri\xe7\xe3o *"}),(0,a.jsx)("textarea",{id:"description",name:"description",rows:4,value:m.description,onChange:g,className:"input-field mt-1",placeholder:"Descreva sua campanha em detalhes...",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700",children:"Data de In\xedcio *"}),(0,a.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:m.start_date,onChange:g,className:"input-field mt-1",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"end_date",className:"block text-sm font-medium text-gray-700",children:"Data de T\xe9rmino *"}),(0,a.jsx)("input",{type:"date",id:"end_date",name:"end_date",value:m.end_date,onChange:g,className:"input-field mt-1",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"budget",className:"block text-sm font-medium text-gray-700",children:"Or\xe7amento (R$)"}),(0,a.jsx)("input",{type:"number",id:"budget",name:"budget",value:m.budget,onChange:f,className:"input-field mt-1",placeholder:"Ex: 1000",min:"0",step:"0.01"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"Objetivos"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"input-field flex-grow",placeholder:"Adicione um objetivo..."}),(0,a.jsx)("button",{type:"button",onClick:()=>{""!==h.trim()&&(u({...m,objectives:[...m.objectives,h.trim()]}),p(""))},className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark",children:"Adicionar"})]}),(0,a.jsx)("div",{className:"space-y-2",children:0===m.objectives.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Nenhum objetivo adicionado"}):(0,a.jsx)("ul",{className:"space-y-2",children:m.objectives.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)("button",{type:"button",onClick:()=>v(t),className:"text-red-500 hover:text-red-700",children:"Remover"})]},t))})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"Regras e Requisitos"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"rules.min_followers",className:"block text-sm font-medium text-gray-700",children:"M\xednimo de Seguidores"}),(0,a.jsx)("input",{type:"number",id:"rules.min_followers",name:"rules.min_followers",value:m.rules.min_followers,onChange:f,className:"input-field mt-1",placeholder:"Ex: 1000",min:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataformas Requeridas"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-4",children:["instagram","tiktok","youtube","twitter"].map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"platform-".concat(e),checked:m.rules.required_platforms.includes(e),onChange:()=>j(e),className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"platform-".concat(e),className:"ml-2 text-sm text-gray-700 capitalize",children:e})]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"rules.content_requirements",className:"block text-sm font-medium text-gray-700",children:"Requisitos de Conte\xfado"}),(0,a.jsx)("textarea",{id:"rules.content_requirements",name:"rules.content_requirements",rows:3,value:m.rules.content_requirements,onChange:g,className:"input-field mt-1",placeholder:"Descreva os requisitos para o conte\xfado..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:x,onChange:e=>b(e.target.value),className:"input-field flex-grow",placeholder:"Adicione uma hashtag..."}),(0,a.jsx)("button",{type:"button",onClick:()=>{""!==x.trim()&&(u({...m,rules:{...m.rules,hashtags:[...m.rules.hashtags,x.trim()]}}),b(""))},className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark",children:"Adicionar"})]}),(0,a.jsx)("div",{className:"mt-2 space-y-2",children:0===m.rules.hashtags.length?(0,a.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Nenhuma hashtag adicionada"}):(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:m.rules.hashtags.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-100 px-3 py-1 rounded-full flex items-center",children:[(0,a.jsxs)("span",{className:"text-sm",children:["#",e]}),(0,a.jsx)("button",{type:"button",onClick:()=>y(t),className:"ml-2 text-gray-500 hover:text-red-500",children:"\xd7"})]},t))})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"requirements.content_type",className:"block text-sm font-medium text-gray-700",children:"Tipo de Conte\xfado"}),(0,a.jsxs)("select",{id:"requirements.content_type",name:"requirements.content_type",value:m.requirements.content_type,onChange:g,className:"input-field mt-1",children:[(0,a.jsx)("option",{value:"post",children:"Post"}),(0,a.jsx)("option",{value:"story",children:"Story"}),(0,a.jsx)("option",{value:"reels",children:"Reels/TikTok"}),(0,a.jsx)("option",{value:"video",children:"V\xeddeo"}),(0,a.jsx)("option",{value:"any",children:"Qualquer"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"requirements.min_posts",className:"block text-sm font-medium text-gray-700",children:"M\xednimo de Publica\xe7\xf5es"}),(0,a.jsx)("input",{type:"number",id:"requirements.min_posts",name:"requirements.min_posts",value:m.requirements.min_posts,onChange:f,className:"input-field mt-1",placeholder:"Ex: 1",min:"1"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"requirements.use_coupon",name:"requirements.use_coupon",checked:m.requirements.use_coupon,onChange:e=>{let{name:t,checked:s}=e.target;if(t.includes(".")){let[e,a]=t.split("."),r=m[e];r&&"object"==typeof r&&u({...m,[e]:{...r,[a]:s}})}else u({...m,[t]:s})},className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"requirements.use_coupon",className:"ml-2 text-sm text-gray-700",children:"Utilizar cupons de desconto"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:l?"Criando...":"Criar Campanha"})]})]})]})}function o(){let e=(0,n.useRouter)(),{user:t}=(0,i._)();return(0,r.useEffect)(()=>{if(!t){e.push("/auth/login");return}(async()=>{try{var s;let a=null===(s=t.user_metadata)||void 0===s?void 0:s.user_type;"brand"!==a&&e.push("/dashboard")}catch(t){console.error("Error checking user type:",t),e.push("/dashboard")}})()},[t,e]),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"md:flex md:items-center md:justify-between mb-8",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Nova Campanha"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Crie uma nova campanha para conectar-se com influenciadores"})]})}),(0,a.jsx)(l,{onSuccess:t=>{e.push("/dashboard/campaigns/".concat(t.id))},onCancel:()=>{e.push("/dashboard/campaigns")}})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[302,441,684,358],()=>t(1685)),_N_E=e.O()}]);